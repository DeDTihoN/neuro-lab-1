# Лабораторна робота: Прогнозування температури за допомогою LSTM на основі датасету Jena Climate

## Вступ

Ця лабораторна робота спрямована на прогнозування температури на основі кліматичних даних з використанням нейронної мережі LSTM (Long Short-Term Memory). Ми використовували датасет **Jena Climate**, який містить метеорологічні дані, зібрані в місті Єна з 2009 по 2016 рік. Основна мета — побудувати модель, яка буде прогнозувати температуру на основі історичних даних.

Ми використовували такі основні кроки:
- Завантаження та попередня обробка даних
- Підготовка вхідних даних для навчання моделі
- Побудова, навчання та оцінка моделі LSTM
- Візуалізація результатів прогнозування

## Попередня обробка даних

Для цього проекту було використано датасет Jena Climate, який завантажено за допомогою бібліотеки `kagglehub`. Основні етапи обробки даних включали:
- Завантаження даних у форматі CSV та створення DataFrame.
- Використання стовпця температури ("T (degC)") як основної цільової змінної.
- Усереднення температурних значень за кожні 24 спостереження для зменшення розмірності даних.
- Масштабування даних до діапазону [0, 1] за допомогою `MinMaxScaler`.

## Підготовка навчальних даних

Навчальні дані були підготовлені шляхом перетворення часових рядів на формат, придатний для моделювання LSTM. Було створено функцію `create_dataset`, яка дозволяє створити послідовності певної довжини (`time_steps`). Дані були розділені на три набори:
- Навчальний набір (80%)
- Валідаційний набір (10%)
- Тестовий набір (10%)

## Архітектура моделі

Модель складається з трьох LSTM шарів:
1. Перший LSTM шар з 100 нейронами, який повертає послідовності для наступного шару.
2. Другий LSTM шар з 50 нейронами, який також повертає послідовності.
3. Третій LSTM шар з 50 нейронами, який не повертає послідовності.

Також використано два шари Dropout для запобігання перенавчанню. Останнім є вихідний Dense шар з одним нейроном для прогнозування.

Модель компільована з оптимізатором Adam, функцією втрат MSE (Mean Squared Error), а також MAE (Mean Absolute Error) як метрикою.

## Навчання моделі

Навчання проводилося протягом 40 епох з використанням розміру пакету (`batch_size`) рівного 16. Для покращення навчання використовувався колбек `EarlyStopping` для зупинки навчання, якщо модель не покращувала свої результати протягом 20 епох.

## Оцінка результатів

Модель була оцінена на тестовому наборі даних за допомогою метрик MSE та MAE. Також було проведено прогнозування на тестових даних і побудовано графік для порівняння реальних значень та прогнозів.

## Порівняння результатів для різних значень `time_steps`

У ході лабораторної роботи були проведені експерименти з різними значеннями `time_steps` (кількість часових кроків для навчання моделі). Нижче наведено таблицю з отриманими результатами для кожного значення:

| Time Steps | Mean Absolute Error (MAE) | Mean Squared Error (MSE) |
|------------|---------------------------|--------------------------|
| 10         | 1.17                      | 2.40                     |
| 30         | 1.19                      | 2.37                     |
| 50         | 1.25                      | 2.62                     |
| 100        | 1.57                      | 4.10                     |

### Аналіз отриманих результатів

- **Time Steps = 10 та 30**: Ці моделі дали найкращі результати з точки зору MAE та MSE, з незначними відмінностями між ними. Зменшення кількості часових кроків призвело до зменшення помилки.
- **Time Steps = 50**: MAE та MSE трохи зросли, що свідчить про певне погіршення здатності моделі прогнозувати з більшою кількістю часових кроків.
- **Time Steps = 100**: Збільшення кількості часових кроків до 100 значно погіршило результати, що може свідчити про перенавчання або про те, що модель не здатна ефективно використовувати настільки довгу історію.

Таким чином, оптимальними значеннями `time_steps` для цієї моделі виявилися 10 або 30, оскільки вони забезпечують найменші значення MAE та MSE.

## Висновки

У ході виконання лабораторної роботи ми створили модель для прогнозування температури на основі кліматичних даних, використовуючи LSTM. Було показано, що кількість часових кроків (`time_steps`) суттєво впливає на точність моделі. Надто велика кількість часових кроків може призвести до погіршення результатів, тоді як коротші послідовності дають кращі прогнози. Модель з `time_steps = 10` чи `30` виявилася найкращою для даної задачі.




